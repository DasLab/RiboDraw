<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of update_tertiary_contact_names</title>
  <meta name="keywords" content="update_tertiary_contact_names">
  <meta name="description" content="update_tertiary_contact_names( tags, print_stuff )">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html linkers -->
<h1>update_tertiary_contact_names
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>update_tertiary_contact_names( tags, print_stuff )</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function update_tertiary_contact_names( tags, print_stuff ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> update_tertiary_contact_names( tags, print_stuff )
 update_tertiary_contact_names( tag, print_stuff )</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="draw_linker.html" class="code" title="function linker = draw_linker( linker )">draw_linker</a>	linker = draw_linker( linker )</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="setup_tertiary_contact.html" class="code" title="function tertiary_contact = setup_tertiary_contact( contact_name, res1_string, res2_string, template_linker, skip_move_stuff_to_back, print_stuff )">setup_tertiary_contact</a>	setup_tertiary_contact( contact_name, res_tags1, res_tags2)</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [name,rgb] = get_partner_name( res_tag )</a></li><li><a href="#_sub2" class="code">function [name,rgb] = get_helix_name( helix, residue )</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function update_tertiary_contact_names( tags, print_stuff )</a>
0002 <span class="comment">% update_tertiary_contact_names( tags, print_stuff )</span>
0003 <span class="comment">% update_tertiary_contact_names( tag, print_stuff )</span>
0004 <span class="comment">%</span>
0005 
0006 <span class="keyword">if</span> ~exist( <span class="string">'print_stuff'</span> ) print_stuff = 1; <span class="keyword">end</span>;
0007 <span class="keyword">if</span> ~exist( <span class="string">'tags'</span>,<span class="string">'var'</span> )
0008     tags = get_tags( <span class="string">'Tertiary'</span> );
0009 <span class="keyword">end</span>
0010 <span class="keyword">if</span> ischar( tags ); tags = {tags}; <span class="keyword">end</span>;
0011 
0012 <span class="keyword">for</span> i = 1:length( tags )
0013     tertiary_contact = getappdata( gca, tags{i} );
0014     name1 = <a href="#_sub1" class="code" title="subfunction [name,rgb] = get_partner_name( res_tag )">get_partner_name</a>( tertiary_contact.associated_residues1{1}  );
0015     name2 = <a href="#_sub1" class="code" title="subfunction [name,rgb] = get_partner_name( res_tag )">get_partner_name</a>( tertiary_contact.associated_residues2{1}  );
0016     <span class="keyword">if</span> length( name1 ) == 0; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0017     <span class="keyword">if</span> length( name2 ) == 0; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0018     tertiary_contact.name = [ name1, <span class="string">'-'</span>, name2 ];
0019     
0020     <span class="comment">% new special case for ligand with interdomain tertiary contacts</span>
0021     residue1 = getappdata( gca, tertiary_contact.associated_residues1{1}  );
0022     <span class="keyword">if</span> isfield( residue1, <span class="string">'ligand_partners'</span> )
0023         linker_tags = unique(get_tags( <span class="string">'Linker'</span>,<span class="string">'interdomain'</span>,residue1.linkers));
0024         <span class="keyword">if</span> length( linker_tags ) &gt; 0
0025             all_name = {name1};
0026             name = sprintf(<span class="string">'\\color{black}%s'</span>,name1);
0027             <span class="keyword">for</span> j = 1:length( linker_tags )
0028                 linker = getappdata( gca, linker_tags{j} );
0029                 [name2,rgb2] = <a href="#_sub1" class="code" title="subfunction [name,rgb] = get_partner_name( res_tag )">get_partner_name</a>( linker.residue2 );
0030                 <span class="keyword">if</span> any( strcmp( all_name, name2 ) ) <span class="keyword">continue</span>; <span class="keyword">end</span>; <span class="comment">% don't repeat</span>
0031                 all_name = [all_name, name2];
0032                 <span class="keyword">if</span> mod(length(all_name),3) == 1; name = [name,<span class="string">'\newline'</span>]; <span class="keyword">end</span>;
0033                 name = sprintf(<span class="string">'%s-\\color[rgb]{%4.2f,%4.2f,%4.2f}%s'</span>,name,rgb2(1),rgb2(2),rgb2(3),name2);
0034             <span class="keyword">end</span>
0035             tertiary_contact.name = name;
0036         <span class="keyword">end</span>
0037     <span class="keyword">end</span>
0038     
0039     <span class="keyword">if</span> print_stuff; fprintf( <span class="string">'Setting tertiary contact name %s for contact %s\n'</span>, tertiary_contact.name,tags{i} ); <span class="keyword">end</span>;
0040     setappdata( gca, tags{i}, tertiary_contact );
0041     <span class="keyword">if</span> isfield( tertiary_contact, <span class="string">'interdomain_linker'</span> ); <a href="draw_linker.html" class="code" title="function linker = draw_linker( linker )">draw_linker</a>( tertiary_contact.interdomain_linker ); <span class="keyword">end</span>;
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0045 <a name="_sub1" href="#_subfunctions" class="code">function [name,rgb] = get_partner_name( res_tag )</a>
0046 residue = getappdata( gca, res_tag);
0047 name = <span class="string">''</span>;
0048 rgb = [0,0,0];
0049 <span class="keyword">if</span> isfield( residue, <span class="string">'ligand_partners'</span> );
0050     <span class="keyword">if</span> isfield( residue, <span class="string">'rgb_color'</span> ) rgb = residue.rgb_color; <span class="keyword">end</span>;
0051     name = residue.nucleotide;
0052     <span class="keyword">return</span>;
0053 <span class="keyword">elseif</span> isfield( residue, <span class="string">'helix_tag'</span> )
0054     helix = getappdata( gca, residue.helix_tag );
0055     [name,rgb] = <a href="#_sub2" class="code" title="subfunction [name,rgb] = get_helix_name( helix, residue )">get_helix_name</a>( helix, residue );
0056     <span class="keyword">return</span>;
0057 <span class="keyword">end</span>
0058 
0059 
0060 
0061 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0062 <a name="_sub2" href="#_subfunctions" class="code">function [name,rgb] = get_helix_name( helix, residue )</a>
0063 rgb = [0,0,0];
0064 helix_res_tag = sprintf( <span class="string">'Residue_%s%s%d'</span>, helix.chain1(1), helix.segid1{1}, helix.resnum1(1) );
0065 helix_residue = getappdata( gca, helix_res_tag );
0066 <span class="keyword">if</span> isfield( helix_residue, <span class="string">'rgb_color'</span> ) rgb = helix_residue.rgb_color; <span class="keyword">end</span>;
0067 <span class="keyword">if</span> isfield( helix_residue, <span class="string">'associated_selections'</span> )
0068     tags = get_tags( <span class="string">'Selection'</span>, <span class="string">'helixgroup_domain'</span>,helix_residue.associated_selections);
0069     <span class="keyword">if</span> length( tags ) &gt; 0
0070         helixgroup = getappdata( gca, tags{1} );
0071         name = helixgroup.name;
0072         <span class="keyword">return</span>;
0073     <span class="keyword">end</span>
0074 <span class="keyword">end</span>
0075 
0076 <span class="keyword">if</span> length( helix.name ) &gt; 0; 
0077     name = helix.name;
0078     <span class="keyword">return</span>;
0079 <span class="keyword">end</span>
0080 
0081 <span class="comment">% backup.</span>
0082 <span class="keyword">if</span> isfield( residue, <span class="string">'rgb_color'</span> ) rgb = residue.rgb_color; <span class="keyword">end</span>;
0083 name = sprintf( <span class="string">'%s%s%d'</span>, residue.chain,residue.segid, residue.resnum );
0084 
0085</pre></div>
<hr><address>Generated on Fri 17-Nov-2017 21:30:16 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>