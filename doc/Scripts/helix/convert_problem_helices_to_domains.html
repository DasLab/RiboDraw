<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of convert_problem_helices_to_domains</title>
  <meta name="keywords" content="convert_problem_helices_to_domains">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">Scripts</a> &gt; <a href="index.html">helix</a> &gt; convert_problem_helices_to_domains.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for Scripts/helix&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>convert_problem_helices_to_domains
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function convert_problem_helices_to_domains() </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="draw_helix.html" class="code" title="function helix = draw_helix( helix )">draw_helix</a>	helix = draw_helix( helix )</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function convert_problem_helices_to_domains()</a>
0002 helix_tags = get_tags( <span class="string">'Helix_'</span> );
0003 <span class="keyword">for</span> i = 1:length( helix_tags )
0004     helix_tag = helix_tags{i};
0005     helix = getappdata( gca, helix_tag );
0006     <span class="comment">% get res_tags that are *inside* helix (and not loop residues nearby)</span>
0007     res_tags = {};
0008      <span class="keyword">for</span> j = 1:length( helix.resnum1 )
0009         res_tags = [res_tags, sprintf( <span class="string">'Residue_%s%s%d'</span>, helix.chain1(j), helix.segid1{j}, helix.resnum1(j) ) ];
0010     <span class="keyword">end</span>
0011     <span class="keyword">for</span> j = 1:length( helix.resnum2 )
0012         res_tags = [res_tags, sprintf( <span class="string">'Residue_%s%s%d'</span>, helix.chain2(j), helix.segid2{j},helix.resnum2(j) ) ];
0013     <span class="keyword">end</span>
0014     res_in_helix = 1;
0015     helix_tags_for_helix_res = {};
0016     <span class="keyword">for</span> j = 1:length( res_tags )
0017         <span class="keyword">if</span> ~isappdata( gca, res_tags{j} ) <span class="keyword">continue</span>; <span class="keyword">end</span>;
0018         residue = getappdata( gca, res_tags{j} );
0019         helix_tags_for_helix_res = [helix_tags_for_helix_res, residue.helix_tag ];
0020     <span class="keyword">end</span>
0021     <span class="keyword">if</span> any( ~strcmp( helix_tags_for_helix_res, helix_tag ) )
0022         helix_tags_for_helix_res = unique( helix_tags_for_helix_res );
0023         <span class="keyword">if</span> length( setdiff( helix_tags_for_helix_res, helix_tag ) ) == 1 
0024             <span class="comment">% maybe this is just a mistake, and there's an obvious helix to</span>
0025             <span class="comment">% which these residues can be reassigned. (happened in C1196 in my</span>
0026             <span class="comment">% ribosome layout)</span>
0027             old_helix_tag = helix_tags_for_helix_res{1};
0028             fprintf( <span class="string">'Helix_tag mismatch for %s -- some residues are misassigned to %s and will be fixed\n'</span>, helix_tag, old_helix_tag  );
0029             <span class="keyword">for</span> j = 1:length( res_tags )
0030                 residue = getappdata( gca, res_tags{j} );
0031                 residue.helix_tag = helix_tag;
0032                 setappdata( gca, residue.res_tag, residue );                
0033             <span class="keyword">end</span>
0034             helix.associated_residues = res_tags;
0035             <a href="draw_helix.html" class="code" title="function helix = draw_helix( helix )">draw_helix</a>( helix );
0036         <span class="keyword">elseif</span> ~any( strcmp( helix_tags_for_helix_res, helix_tag ) )
0037             new_name = <span class="string">'Domain'</span>;
0038             <span class="keyword">for</span> k = 1:length( helix_tags_for_helix_res )
0039                 other_helix = getappdata( gca, helix_tags_for_helix_res{k} );
0040                 helix_name = other_helix.name;
0041                 <span class="keyword">if</span> length( helix_name ) == 0; helix_name = other_helix.tag; <span class="keyword">end</span>;
0042                 new_name = [new_name, <span class="string">'_'</span>, helix_name ];
0043             <span class="keyword">end</span>
0044             fprintf( <span class="string">'All res in helix %s are associated with other helices-- will convert this helix to a domain %s.\n'</span>, helix_tag, new_name );
0045             <span class="comment">% need to go and fix up linkers.</span>
0046             <span class="comment">% a funny hack -- change linker's type from stem_pair to</span>
0047             <span class="comment">% noncanonical -- that will allow user remodeling.</span>
0048             N = length( helix.resnum1 );
0049             <span class="keyword">for</span> j = 1:N
0050                 linker_tag = sprintf(<span class="string">'Linker_%s%s%d_%s%s%d_stem_pair'</span>, helix.chain1(j), helix.segid1{j}, helix.resnum1(j),<span class="keyword">...</span>
0051                     helix.chain2(N-j+1), helix.segid2{j}, helix.resnum2(N-j+1) );
0052                 <span class="keyword">if</span> isappdata( gca, linker_tag )
0053                     linker = getappdata( gca, linker_tag );
0054                     linker.type = <span class="string">'long_range_stem_pair'</span>;
0055                     linker.edge1 = <span class="string">'W'</span>;
0056                     linker.edge2 = <span class="string">'W'</span>;
0057                     linker.LW_orientation = <span class="string">'C'</span>;
0058                     <span class="keyword">if</span> isfield( linker, <span class="string">'line_handle'</span> ) delete( linker.line_handle ); rmfield( linker, <span class="string">'line_handle'</span> ); <span class="keyword">end</span>;
0059                     <span class="keyword">if</span> isfield( linker, <span class="string">'symbol'</span> ) delete( linker.symbol ); rmfield( linker, <span class="string">'symbol'</span> ); <span class="keyword">end</span>;
0060                     linker_tag = strrep( linker_tag, <span class="string">'stem_pair'</span>,<span class="string">'long_range_stem_pair'</span> );
0061                     <span class="keyword">if</span> ~isappdata( gca, linker_tag )
0062                         setappdata( gca, linker_tag, linker );
0063                     <span class="keyword">end</span>
0064                 <span class="keyword">end</span>
0065             <span class="keyword">end</span>
0066             setup_domain( res_tags, new_name );
0067             <span class="keyword">for</span> k = 1:length( helix_tags_for_helix_res )
0068                 <a href="draw_helix.html" class="code" title="function helix = draw_helix( helix )">draw_helix</a>( getappdata( gca, helix_tags_for_helix_res{k} ) );
0069             <span class="keyword">end</span>
0070             rmappdata( gca, helix_tag )
0071         <span class="keyword">else</span>
0072             helix_tags_for_helix_res
0073             fprintf( <span class="string">'Some problem with helix %s in which its core residues do not have the right helix_tag\n'</span>, helix_tag );
0074         <span class="keyword">end</span>
0075     <span class="keyword">end</span>
0076 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 17-Nov-2017 17:25:01 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>