<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of group_interdomain_linkers</title>
  <meta name="keywords" content="group_interdomain_linkers">
  <meta name="description" content="linker_groups = group_interdomain_linkers( domain_names )">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html linkers -->
<h1>group_interdomain_linkers
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>linker_groups = group_interdomain_linkers( domain_names )</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function linker_groups = group_interdomain_linkers( domain_names ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> linker_groups = group_interdomain_linkers( domain_names )</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="get_interdomain_linkers.html" class="code" title="function interdomain_linkers = get_interdomain_linkers( linkers, domain_names )">get_interdomain_linkers</a>	interdomain_linkers = get_interdomain_linkers( linkers, domain_names )</li><li><a href="hide_interdomain_noncanonical_pairs.html" class="code" title="function hide_interdomain_noncanonical_pairs();">hide_interdomain_noncanonical_pairs</a>	</li><li><a href="setup_tertiary_contact.html" class="code" title="function tertiary_contact = setup_tertiary_contact( contact_name, res1_string, res2_string, template_linker, skip_move_stuff_to_back, print_stuff )">setup_tertiary_contact</a>	setup_tertiary_contact( contact_name, res_tags1, res_tags2)</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function match = check_sequence_close( residue, other_res_tag )</a></li><li><a href="#_sub2" class="code">function linker_groups_filter = filter_groups_without_pairs( linker_groups );</a></li><li><a href="#_sub3" class="code">function [res_tags1,res_tags2] = get_res_tags( linker_group );</a></li><li><a href="#_sub4" class="code">function main_linker = find_shortest_possible_linker( linker_group, linker_types );</a></li><li><a href="#_sub5" class="code">function main_linker = look_for_previous_tertiary_contact( res_tags1, res_tags2 );</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function linker_groups = group_interdomain_linkers( domain_names )</a>
0002 <span class="comment">% linker_groups = group_interdomain_linkers( domain_names )</span>
0003 linker_groups = {};
0004 <span class="keyword">if</span> ~exist( <span class="string">'domain_names'</span>, <span class="string">'var'</span> ) | ~iscell( domain_names ) | length( domain_names ) &lt; 2;
0005     fprintf( <span class="string">'Provide at least two domain names'</span> ); <span class="keyword">return</span>;
0006 <span class="keyword">end</span>
0007 
0008 <span class="comment">% get interdomain_linkers</span>
0009 linkers = {};
0010 <span class="comment">% order of preference</span>
0011 linker_types = {<span class="string">'ligand'</span>,<span class="string">'noncanonical_pair'</span>,<span class="string">'long_range_stem_pair'</span>,<span class="string">'stack'</span>,<span class="string">'other_contact'</span>};
0012 <span class="keyword">for</span> i = 1:length( linker_types )
0013     linkers = [ linkers; get_tags( <span class="string">'Linker'</span>, linker_types{i} ) ];
0014 <span class="keyword">end</span>
0015 
0016 interdomain_linkers = <a href="get_interdomain_linkers.html" class="code" title="function interdomain_linkers = get_interdomain_linkers( linkers, domain_names )">get_interdomain_linkers</a>( linkers, domain_names );
0017 
0018 <span class="comment">% now group by domain.</span>
0019 linker_groups = {};
0020 <span class="keyword">for</span> i = 1:length( interdomain_linkers )
0021     linker = interdomain_linkers{i};
0022     match = 0; switch_res = 0;
0023     residue1 = getappdata( gca, linker.residue1 );
0024     residue2 = getappdata( gca, linker.residue2 );
0025     <span class="keyword">for</span> j = 1:length( linker_groups )
0026         <span class="comment">% look for match of domain (as defined by rgb color )</span>
0027         <span class="keyword">if</span> ( strcmp( linker.domain1, linker_groups{j}{1}.domain1 ) &amp; <span class="keyword">...</span>
0028                 strcmp( linker.domain2, linker_groups{j}{1}.domain2 ) )
0029             <span class="keyword">if</span> ( <a href="#_sub1" class="code" title="subfunction match = check_sequence_close( residue, other_res_tag )">check_sequence_close</a>( residue1, linker_groups{j}{1}.residue1 ) &amp; <span class="keyword">...</span>
0030                     <a href="#_sub1" class="code" title="subfunction match = check_sequence_close( residue, other_res_tag )">check_sequence_close</a>( residue2, linker_groups{j}{1}.residue2 ) )
0031                 match = j; switch_res = 0; <span class="keyword">break</span>;
0032             <span class="keyword">end</span>
0033         <span class="keyword">end</span>
0034         <span class="keyword">if</span> ( strcmp( linker.domain1, linker_groups{j}{1}.domain2 ) &amp; <span class="keyword">...</span>
0035                 strcmp( linker.domain2, linker_groups{j}{1}.domain1 ) )
0036             <span class="keyword">if</span> ( <a href="#_sub1" class="code" title="subfunction match = check_sequence_close( residue, other_res_tag )">check_sequence_close</a>( residue1, linker_groups{j}{1}.residue2 ) &amp; <span class="keyword">...</span>
0037                     <a href="#_sub1" class="code" title="subfunction match = check_sequence_close( residue, other_res_tag )">check_sequence_close</a>( residue2, linker_groups{j}{1}.residue1 ) )
0038                 match = j; switch_res = 1; <span class="keyword">break</span>;
0039             <span class="keyword">end</span>
0040         <span class="keyword">end</span>
0041     <span class="keyword">end</span>
0042     <span class="keyword">if</span> match 
0043         <span class="keyword">if</span> switch_res
0044             <span class="comment">% used to define associated_residues for tertiary_contacts --</span>
0045             <span class="comment">% see below</span>
0046             res1 = linker.residue1;
0047             res2 = linker.residue2;
0048             linker.residue1 = res2;
0049             linker.residue2 = res1;
0050         <span class="keyword">end</span>
0051         linker_groups{match} = [ linker_groups{match}, linker ];
0052     <span class="keyword">else</span>
0053         linker_groups = [ linker_groups, {{linker}} ];
0054     <span class="keyword">end</span>
0055 <span class="comment">%     if ~isfield( linker, 'plot_pos' )</span>
0056 <span class="comment">%         fprintf( 'Need to figure out where linker is... drawing it temporarily\n' );</span>
0057 <span class="comment">%         show_interdomain_noncanonical_pairs;</span>
0058 <span class="comment">%         show_ligand_linkers;</span>
0059 <span class="comment">%     end</span>
0060 <span class="keyword">end</span>
0061 
0062 <span class="comment">% get rid of any linker groups that are all stacks...</span>
0063 linker_groups = <a href="#_sub2" class="code" title="subfunction linker_groups_filter = filter_groups_without_pairs( linker_groups );">filter_groups_without_pairs</a>( linker_groups );
0064 
0065 <span class="comment">% allows quick check by eye...</span>
0066 <span class="keyword">for</span> i = 1:length( linker_groups )
0067     color = rand(3,1);
0068     linker_group = linker_groups{i};
0069     <span class="keyword">for</span> j = 1:length( linker_group )
0070         linker = linker_group{j};
0071         <span class="keyword">if</span> isfield( linker, <span class="string">'line_handle'</span> ) set( linker.line_handle, <span class="string">'color'</span>, color ); <span class="keyword">end</span>;
0072     <span class="keyword">end</span>
0073 <span class="keyword">end</span>
0074 
0075 <span class="comment">% let's try to set up a tertiary contact</span>
0076 <span class="keyword">for</span> i = 1:length( linker_groups )
0077     linker_group = linker_groups{i};
0078 
0079     <span class="comment">% need to assign a pair of interdomain connection residues.</span>
0080     [res_tags1, res_tags2 ] = <a href="#_sub3" class="code" title="subfunction [res_tags1,res_tags2] = get_res_tags( linker_group );">get_res_tags</a>( linker_group );
0081     main_linker = <a href="#_sub5" class="code" title="subfunction main_linker = look_for_previous_tertiary_contact( res_tags1, res_tags2 );">look_for_previous_tertiary_contact</a>( res_tags1, res_tags2 );
0082     <span class="keyword">if</span> isempty( main_linker ) main_linker = <a href="#_sub4" class="code" title="subfunction main_linker = find_shortest_possible_linker( linker_group, linker_types );">find_shortest_possible_linker</a>( linker_group, linker_types ); <span class="keyword">end</span>;
0083             
0084     <span class="comment">% get all residues involved in tertiary contact.</span>
0085     residue1 = getappdata( gca, main_linker.residue1 );
0086     residue2 = getappdata( gca, main_linker.residue2 );
0087     res_tags1 = [main_linker.residue1, setdiff( unique( res_tags1 ), main_linker.residue1 ) ];
0088     res_tags2 = [main_linker.residue2, setdiff( unique( res_tags2 ), main_linker.residue2 ) ];
0089 
0090     tertiary_contact_tag = <a href="setup_tertiary_contact.html" class="code" title="function tertiary_contact = setup_tertiary_contact( contact_name, res1_string, res2_string, template_linker, skip_move_stuff_to_back, print_stuff )">setup_tertiary_contact</a>( <span class="string">''</span>, res_tags1, res_tags2, main_linker, 1 );
0091 <span class="keyword">end</span>
0092 
0093 <a href="hide_interdomain_noncanonical_pairs.html" class="code" title="function hide_interdomain_noncanonical_pairs();">hide_interdomain_noncanonical_pairs</a>;
0094 hide_ligand_linkers;
0095 move_stuff_to_back;
0096 
0097 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0098 <a name="_sub1" href="#_subfunctions" class="code">function match = check_sequence_close( residue, other_res_tag ) </a>
0099 <span class="comment">% now look for closeness, based on all residues in parent helix.</span>
0100 other_res = getappdata( gca, other_res_tag );
0101 helix = getappdata( gca, other_res.helix_tag );
0102 match = 0;
0103 <span class="keyword">for</span> k = 1:length( helix.associated_residues )
0104     other_helix_res = getappdata( gca, helix.associated_residues{k} );
0105     <span class="keyword">if</span> strcmp( other_helix_res.chain, residue.chain ) &amp; <span class="keyword">...</span>
0106             strcmp( other_helix_res.segid, residue.segid ) &amp; <span class="keyword">...</span>
0107             abs( other_helix_res.resnum - residue.resnum ) &lt;= 5
0108         match = 1; <span class="keyword">return</span>;
0109     <span class="keyword">end</span>
0110 <span class="keyword">end</span>
0111 
0112 
0113 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0114 <a name="_sub2" href="#_subfunctions" class="code">function linker_groups_filter = filter_groups_without_pairs( linker_groups );</a>
0115 linker_groups_filter = {};
0116 <span class="keyword">for</span> i = 1:length( linker_groups )
0117     linker_group = linker_groups{i};
0118     ok = 0;
0119     <span class="keyword">for</span> j = 1:length( linker_group )
0120         linker = linker_group{j};
0121         <span class="keyword">if</span> any(strcmp( linker.type, {<span class="string">'noncanonical_pair'</span>,<span class="string">'ligand'</span>,<span class="string">'long_range_stem_pair'</span>} ) )
0122             ok = 1;
0123             <span class="keyword">break</span>;
0124         <span class="keyword">end</span>
0125     <span class="keyword">end</span>
0126     <span class="keyword">if</span> ok
0127         linker_groups_filter = [ linker_groups_filter, {linker_group} ];
0128     <span class="keyword">end</span>
0129 <span class="keyword">end</span>
0130 
0131 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0132 <a name="_sub3" href="#_subfunctions" class="code">function [res_tags1,res_tags2] = get_res_tags( linker_group );</a>
0133 res_tags1 = {};
0134 res_tags2 = {};
0135 <span class="keyword">for</span> j = 1:length( linker_group )
0136     linker = linker_group{j};
0137     res_tags1 = [res_tags1, linker.residue1 ];
0138     res_tags2 = [res_tags2, linker.residue2 ];
0139 <span class="keyword">end</span>
0140         
0141 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0142 <a name="_sub4" href="#_subfunctions" class="code">function main_linker = find_shortest_possible_linker( linker_group, linker_types );</a>
0143 linker_lengths = [];
0144 <span class="keyword">for</span> j = 1:length( linker_group )
0145     linker = linker_group{j};
0146     linker_length = 0;
0147     <span class="keyword">if</span> isfield( linker, <span class="string">'plot_pos'</span> )
0148         <span class="keyword">for</span> i = 1:size( linker.plot_pos, 1 )-1
0149             linker_length = linker_length + norm( linker.plot_pos( i, : ) - linker.plot_pos( i+1, : ) );
0150         <span class="keyword">end</span>
0151     <span class="keyword">else</span>
0152         res1 = getappdata( gca, linker.residue1 );
0153         res2 = getappdata( gca, linker.residue2 );
0154         linker_length = norm( res1.plot_pos - res2.plot_pos );
0155     <span class="keyword">end</span>
0156     linker_lengths(j,:) = [find(strcmp(linker.type, linker_types)), linker_length];
0157 <span class="keyword">end</span>
0158 [~, idx ] = sortrows( linker_lengths );
0159 main_linker = linker_group{idx};
0160 
0161 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0162 <a name="_sub5" href="#_subfunctions" class="code">function main_linker = look_for_previous_tertiary_contact( res_tags1, res_tags2 );</a>
0163 main_linker = [];
0164 tags = get_tags( <span class="string">'TertiaryContact'</span> );
0165 <span class="keyword">for</span> i = 1:length( tags )
0166     tertiary_contact = getappdata( gca, tags{i} );
0167     <span class="keyword">if</span> ( any(strcmp(tertiary_contact.associated_residues1{1},res_tags1 )) &amp; <span class="keyword">...</span>
0168             any(strcmp(tertiary_contact.associated_residues2{1},res_tags2 )) )
0169         fprintf( <span class="string">'Found template linker from tertiary contact %s\n'</span>,  tags{i} );
0170         main_linker = getappdata( gca, tertiary_contact.interdomain_linker );
0171         <span class="keyword">return</span>;
0172     <span class="keyword">elseif</span> ( any(strcmp(tertiary_contact.associated_residues2{1},res_tags1 )) &amp; <span class="keyword">...</span>
0173             any(strcmp(tertiary_contact.associated_residues1{1},res_tags2 ))   )
0174         fprintf( <span class="string">'Found template linker from tertiary contact %s\n'</span>,  tags{i} );
0175         main_linker = getappdata( gca, tertiary_contact.interdomain_linker );
0176         res1 = main_linker.residue1;
0177         res2 = main_linker.residue2;
0178         main_linker.residue1 = res2;
0179         main_linker.residue2 = res1;
0180         <span class="keyword">return</span>;
0181     <span class="keyword">end</span>
0182 <span class="keyword">end</span>
0183</pre></div>
<hr><address>Generated on Fri 17-Nov-2017 21:30:16 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>